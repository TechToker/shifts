Using 4 workers in PyTorch dataloading.
RIP kwargs:
{'cache_all_preds': False,
 'device': 'cuda:0',
 'k': 3,
 'model_name': 'bc',
 'num_preds': 5,
 'per_plan_algorithm': 'BCM',
 'per_scene_algorithm': 'BCM',
 'samples_per_model': 10}
Building RIP agent with backbone model bc, per-plan algorithm BCM, per-scene algorithm BCM, 3 ensemble members.
Model kwargs:
{'bc_deterministic': False,
 'device': 'cuda:0',
 'dim_hidden': 512,
 'generation_mode': 'sampling',
 'in_channels': 17,
 'output_shape': [25, 2]}
BC Model: using Gaussian likelihood.
BC Model: using generation mode sampling.
Model kwargs:
{'bc_deterministic': False,
 'device': 'cuda:0',
 'dim_hidden': 512,
 'generation_mode': 'sampling',
 'in_channels': 17,
 'output_shape': [25, 2]}
Using cache found in ../../dataset//torch_hub/pytorch_vision_v0.9.0
Using cache found in ../../dataset//torch_hub/pytorch_vision_v0.9.0
Using cache found in ../../dataset//torch_hub/pytorch_vision_v0.9.0
Traceback (most recent call last):
  File "/home/techtoker/projects/yandex_sdc/shifts-main/sdc/sdc/oatomobile/torch/baselines/robust_imitative_planning.py", line 247, in load_rip_checkpoints
    model._models[
  File "/home/techtoker/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1671, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for BehaviouralModel:
	Missing key(s) in state_dict: "_decoder.weight_ih", "_decoder.weight_hh", "_decoder.bias_ih", "_decoder.bias_hh", "_output.weight", "_output.bias".
	Unexpected key(s) in state_dict: "_flow._decoder.weight_ih", "_flow._decoder.weight_hh", "_flow._decoder.bias_ih", "_flow._decoder.bias_hh", "_flow._locscale._model.0.weight", "_flow._locscale._model.0.bias", "_flow._locscale._model.2.weight", "_flow._locscale._model.2.bias".
During handling of the above exception, another exception occurred:
Traceback (most recent call last):
  File "/home/techtoker/projects/yandex_sdc/shifts-main/sdc/run.py", line 88, in <module>
    main()
  File "/home/techtoker/projects/yandex_sdc/shifts-main/sdc/run.py", line 81, in main
    train(c)
  File "/home/techtoker/projects/yandex_sdc/shifts-main/sdc/sdc/trainer.py", line 88, in train
    model = load_rip_checkpoints(
  File "/home/techtoker/projects/yandex_sdc/shifts-main/sdc/sdc/oatomobile/torch/baselines/robust_imitative_planning.py", line 254, in load_rip_checkpoints
    raise Exception(
Exception: Failed in loading checkpoint at path ../../baseline-models//rip-bc-k_3-plan_bcm-scene_bcm/dim_model-seed-1-epoch-61.pt with exception:
Error(s) in loading state_dict for BehaviouralModel:
	Missing key(s) in state_dict: "_decoder.weight_ih", "_decoder.weight_hh", "_decoder.bias_ih", "_decoder.bias_hh", "_output.weight", "_output.bias".
	Unexpected key(s) in state_dict: "_flow._decoder.weight_ih", "_flow._decoder.weight_hh", "_flow._decoder.bias_ih", "_flow._decoder.bias_hh", "_flow._locscale._model.0.weight", "_flow._locscale._model.0.bias", "_flow._locscale._model.2.weight", "_flow._locscale._model.2.bias".
BC Model: using Gaussian likelihood.
BC Model: using generation mode sampling.
Model kwargs:
{'bc_deterministic': False,
 'device': 'cuda:0',
 'dim_hidden': 512,
 'generation_mode': 'sampling',
 'in_channels': 17,
 'output_shape': [25, 2]}
BC Model: using Gaussian likelihood.
BC Model: using generation mode sampling.
Loaded ensemble member 1 from path ../../baseline-models//rip-bc-k_3-plan_bcm-scene_bcm/bs_model-seed-10-epoch-57.pt